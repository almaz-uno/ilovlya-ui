# GitHub Copilot Instructions для проекта Ilovlya UI

## Описание проекта
Ilovlya UI — это мобильное приложение на Flutter для просмотра и управления медиа-контентом. Приложение позволяет пользователям воспроизводить аудио и видео записи, управлять плейлистами и настройками воспроизведения.

## Технический стек
- **Framework**: Flutter (Dart)
- **State Management**: Riverpod
- **Media Playback**: media_kit
- **UI**: Material Design 3
- **Platform Support**: Android, iOS, Windows, macOS, Linux

## Архитектура проекта

### Структура папок
```
lib/
├── src/
│   ├── api/           # API интеграция и Riverpod провайдеры
│   ├── media/         # Медиа-плееры и компоненты воспроизведения
│   ├── model/         # Модели данных
│   ├── settings/      # Настройки приложения
│   └── widgets/       # Переиспользуемые виджеты
```

### Ключевые компоненты
- `RecordingViewMediaKitHandler` - основной медиа-плеер
- `PlayerControls` - элементы управления воспроизведением
- `MKPlayerHandler` - обработчик media_kit плеера

## Правила кодирования

### Стиль кода
- Используйте `const` конструкторы где возможно
- Следуйте Dart code style guide
- Используйте meaningful names для переменных и функций
- Добавляйте комментарии для сложной логики
- Документация пишется в AsciiDoc, в русских текстах тире должно использоваться согласно русской типографике (—). Заголовки списков, таблиц и др. объектов должны начинаться с точки: `.Описание`


### State Management
- Используйте Riverpod для управления состоянием
- Создавайте отдельные провайдеры для API вызовов
- Используйте `ConsumerWidget` или `ConsumerStatefulWidget`

### Медиа-воспроизведение
- Всегда обрабатывайте ошибки при работе с media_kit
- Учитывайте особенности разных платформ (Platform.isAndroid, etc.)
- Используйте dispose() для освобождения ресурсов плеера

### Локализация
- Поддерживайте русский и английский языки
- Используйте l10n.yaml для настройки локализации
- Все пользовательские строки должны быть локализованы

## Специфические требования

### Медиа-плеер
- Поддержка Bluetooth-гарнитур и системных медиа-кнопок
- Корректная работа на разных скоростях воспроизведения
- Сохранение позиции воспроизведения
- Поддержка перемотки (15с, 30с, 1мин, 5мин)

### UI/UX
- Следуйте Material Design 3 guidelines
- Поддерживайте темную и светлую темы
- Адаптивный дизайн для разных размеров экранов
- Accessibility поддержка

### Производительность
- Ленивая загрузка для больших списков
- Кэширование изображений и данных
- Оптимизация для слабых устройств

## Примеры кода

### Создание Riverpod провайдера
```dart
final exampleProvider = StateNotifierProvider<ExampleNotifier, ExampleState>((ref) {
  return ExampleNotifier(ref);
});
```

### Использование media_kit
```dart
final player = Player();
await player.open(Media(url));
player.stream.position.listen((position) {
  // Handle position changes
});
```

### Platform-specific код
```dart
if (Platform.isAndroid || Platform.isIOS) {
  // Mobile specific code
} else if (Platform.isWindows || Platform.isMacOS || Platform.isLinux) {
  // Desktop specific code
}
```

## Частые задачи

### Добавление нового экрана
1. Создайте виджет в соответствующей папке
2. Добавьте роут в роутер приложения
3. Создайте необходимые провайдеры
4. Добавьте локализацию

### Работа с API
1. Определите модели данных
2. Создайте Riverpod провайдер для API вызова
3. Обработайте ошибки и состояния загрузки
4. Используйте в UI через ConsumerWidget

### Оптимизация производительности
- Используйте `const` конструкторы
- Избегайте пересоздания виджетов в build методах
- Используйте `select` в Riverpod для точечных подписок
- Dispose ресурсы в соответствующих методах

## Тестирование
- Пишите unit тесты для бизнес-логики
- Widget тесты для UI компонентов
- Integration тесты для критичных пользовательских сценариев
- Тестируйте на реальных устройствах разных платформ

## Комментарии для Copilot
При генерации кода:
- Всегда учитывайте кроссплатформенность
- Используйте существующие паттерны проекта
- Добавляйте обработку ошибок
- Следуйте архитектуре с Riverpod
- Учитывайте производительность на мобильных устройствах
- Не забывайте про локализацию строк
